<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Info Lomba — Mading Digital</title>

  <!-- ✅ PAKAI CSS LOMBA TERBARU -->
  <link rel="stylesheet" href="css/lomba.css">
</head>
<body>

  <!-- ✅ NAVBAR -->
  <header class="site-header">
    <div class="brand">
      <h1>Mading Digital</h1>
      <p class="tag">MAN Insan Cendekia Bengkulu Tengah</p>
    </div>
    <nav>
      <a href="index.html">Beranda</a>
      <a href="berita.html">Berita</a>
      <a href="lomba.html" class="active">Info Lomba</a>
      <a href="galeri.html">Galeri</a>
      <a href="aspirasi.html">Aspirasi</a>
    </nav>
  </header>

  <!-- ✅ KONTEN -->
  <main class="container">
    <section class="galeri-header">
      <h2>Info Lomba</h2>
      <p>Informasi perlombaan terbaru untuk siswa</p>
    </section>

    <section id="list-lomba" class="galeri-grid"></section>
  </main>

  <footer class="site-footer">
    &copy; 2025 Mading Digital MAN Insan Cendekia Bengkulu Tengah
  </footer>

  <!-- ✅ MODAL DETAIL -->
  <div id="lbModal" class="gl-modal hidden">
    <div class="gl-panel">
      <button class="gl-close" id="lbClose">✕</button>

      <!-- ✅ AREA SLIDER GAMBAR -->
      <div class="gl-media" id="lbMedia"></div>

      <!-- ✅ KONTEN -->
      <div class="gl-content">
        <h2 id="lbTitle"></h2>
        <div id="lbDesc" class="gl-desc"></div>
      </div>
    </div>
  </div>

  <script src="js/app.js"></script>

  <script>
  (function(){
    const list   = document.getElementById('list-lomba');
    const modal  = document.getElementById('lbModal');
    const media  = document.getElementById('lbMedia');
    const title  = document.getElementById('lbTitle');
    const desc   = document.getElementById('lbDesc');
    const close  = document.getElementById('lbClose');

    function getData(){
      try{
        const raw = localStorage.getItem('madingData');
        if(!raw) return [];
        return JSON.parse(raw).lomba || [];
      }catch(e){
        return [];
      }
    }

    function firstImage(g){
      if(!g) return '';
      if(Array.isArray(g)) return g[0] || '';
      if(typeof g === 'string') return g;
      return '';
    }

    function render(){
      const items = getData();

      if(!items.length){
        list.innerHTML = "<p style='opacity:.6'>Belum ada info lomba.</p>";
        return;
      }

      list.innerHTML = items.map((it,i)=>`
        <article class="galeri-card" data-i="${i}">
          <img src="${firstImage(it.gambar) || ''}" alt="${it.judul || ''}">
          <div class="galeri-overlay">
            <h4>${it.judul || ''}</h4>
          </div>
        </article>
      `).join("");

      document.querySelectorAll('.galeri-card').forEach(card=>{
        card.onclick = ()=>{
          const data = items[card.dataset.i];

          title.textContent = data.judul || '';
          desc.innerHTML    = data.isi || 'Tidak ada deskripsi';

          // ✅ ISI SLIDER
          media.innerHTML = "";

          let images = [];
          if(Array.isArray(data.gambar)) images = data.gambar;
          else if(typeof data.gambar === 'string') images = [data.gambar];

          images.forEach(url=>{
            const img = document.createElement("img");
            img.src = url;
            media.appendChild(img);
          });

          modal.classList.remove('hidden');
        };
      });
    }

    close.onclick = ()=> modal.classList.add('hidden');
    modal.onclick = e=>{
      if(e.target === modal) modal.classList.add('hidden');
    };

    render();
  })();
  </script>

</body>
</html>
